<!DOCTYPE html>

<!--
Src: https://observablehq.com/@observablehq/plot-labeled-multi-line-chart
-->

<div id="myplot"></div>
<script type="module">

import * as Plot from "https://cdn.jsdelivr.net/npm/@observablehq/plot@0.6/+esm";
import * as d3 from "https://cdn.jsdelivr.net/npm/d3@7/+esm";

const stocks = [
  ["AAPL", await d3.csv("aapl.csv", d3.autoType)],
  ["AMZN", await d3.csv("amzn.csv", d3.autoType)],
  ["GOOG", await d3.csv("goog.csv", d3.autoType)],
  ["IBM",  await d3.csv("ibm.csv", d3.autoType)],
].flatMap(([Symbol, values]) => values.map(d => ({Symbol, ...d})))

const plot = Plot.plot({
  style: "overflow: visible;",
  y: {grid: true},
  marks: [
    Plot.ruleY([0]),
    Plot.lineY(stocks, {x: "Date", y: "Close", stroke: "Symbol"}),
    Plot.text(stocks, Plot.selectLast({x: "Date", y: "Close", z: "Symbol", text: "Symbol", textAnchor: "start", dx: 3}))
  ]
});

const div = document.querySelector("#myplot");
div.append(plot);

</script>